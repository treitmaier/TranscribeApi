import kotlinx.datetime.Instant;
import kotlinx.datetime.LocalDateTime;
import xyz.reitmaier.transcribe.data.TaskId;
import xyz.reitmaier.transcribe.data.TaskProvenance;
import xyz.reitmaier.transcribe.data.UserId;

-- user is reserved word in postgres -> users
CREATE TABLE IF NOT EXISTS task
(
    id INT AS TaskId NOT NULL PRIMARY KEY AUTO_INCREMENT,
    user_id INT AS UserId NOT NULL REFERENCES user(id),
    path VARCHAR(255) NOT NULL,
    length BIGINT NOT NULL,
    provenance VARCHAR(255) AS TaskProvenance NOT NULL,
    display_name VARCHAR(255) NOT NULL,
    created_at TIMESTAMP AS LocalDateTime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP AS LocalDateTime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
--     fcm_token  TEXT AS FcmToken
    CONSTRAINT path_unique UNIQUE (path)
);

-- CREATE TABLE IF NOT EXISTS Task_Entity
-- (
--     id SERIAL8 AS TaskId PRIMARY KEY,
--     user_id INT AS UserId  NOT NULL REFERENCES User_Entity(id),
--     path VARCHAR(255) NOT NULL UNIQUE,
--     created_at TIMESTAMP AS LocalDateTime NOT NULL DEFAULT CURRENT_TIMESTAMP
-- );
-- CREATE TABLE IF NOT EXISTS Task_Entity
-- (
--     id SERIAL8 AS TaskId PRIMARY KEY,
--     user_id INT AS UserId  NOT NULL REFERENCES User_Entity(id),
--     path VARCHAR(255) NOT NULL UNIQUE,
--     created_at TIMESTAMP AS LocalDateTime NOT NULL DEFAULT CURRENT_TIMESTAMP
-- );
